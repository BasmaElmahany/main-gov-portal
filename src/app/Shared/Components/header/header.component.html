<header class="gov-header">

  <!-- =====================================================
       1) UTILITY BAR (Top strip)
  ====================================================== -->
  <div class="utility-bar">
    <div class="container utility-inner" [attr.dir]="lang.dir">

      <!-- Left utility links -->
      <div class="utility-left">
        <a class="u-link" routerLink="/contact" title="Contact us">
          <mat-icon>call</mat-icon>
          <span>{{ lang.current === 'ar' ? 'اتصل بنا' : 'Contact' }}</span>
        </a>

        <span class="dot"></span>

        <a class="u-link" routerLink="/archive" title="Announcements">
          <mat-icon>campaign</mat-icon>
          <span>{{ lang.current === 'ar' ? 'الإعلانات' : 'Announcements' }}</span>
        </a>

        <span class="dot"></span>

        <a class="u-link" routerLink="/services" title="Services">
          <mat-icon>apps</mat-icon>
          <span>{{ lang.current === 'ar' ? 'الخدمات' : 'Services' }}</span>
        </a>
      </div>

      <!-- Right utility actions -->
      <div class="utility-right">
        <button mat-stroked-button class="lang-btn" (click)="toggleLang()" title="Toggle language">
          <mat-icon>translate</mat-icon>
          <span>{{ lang.current === 'ar' ? 'EN' : 'AR' }}</span>
        </button>

        <button mat-stroked-button class="acc-btn" type="button" title="Accessibility options">
          <mat-icon>accessibility_new</mat-icon>
          <span>{{ lang.current === 'ar' ? 'إتاحة' : 'Accessibility' }}</span>
        </button>
      </div>

    </div>
  </div>

  <!-- =====================================================
       2) MAIN BAR (Brand + Search + Mobile Menu)
  ====================================================== -->
  <header class="gov-hero-header" style="background-color: #f3f8f8;" [attr.dir]="lang.dir">

    <!-- Right Logo -->
    <div class="side-logo start">
      <img src="assets/images/app_icon-removebg-preview.png" style="width: 200px;height: 200px;" alt="Minya Logo" />
    </div>

    <!-- Center Content -->
    <div class="hero-center">
      <h1>{{ 'portalTitle' | t }}</h1>
      <h2>{{ 'governorate' | t }}</h2>


    </div>

    <!-- Left Logo -->
    <div class="side-logo end">

      <img src="assets/images/egypt-coat-arms-8078012-removebg-preview.png"
        style="width: 200px;height: 100px; margin-top: 45px;" alt="Cairo Logo" />

      <div class="hero-search side-search">
        <mat-icon>search</mat-icon>
        <input type="text" [placeholder]="'searchPlaceholder' | t" />
      </div>

    </div>


  </header>

  <!-- =====================================================
       3) DESKTOP NAV BAR
  ====================================================== -->
  <nav class="menu-bar">
    <div class="container menu-inner" [attr.dir]="lang.dir">


      <!-- Basic links -->
      <a *ngFor="let item of nav" class="menu-link" [routerLink]="item.path" routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: item.path === '/home' }">
        {{ item.key | t }}
      </a>


      <!-- <a
        *ngFor="let item of nav"
        class="menu-link"
        [routerLink]="item.path"
        routerLinkActive="active"
        [routerLinkActiveOptions]="{ exact: item.path === '/govtours' }">
        {{ item.key | t }}
      </a> -->

      <!-- Services Mega Trigger -->
      <button mat-button class="menu-link menu-trigger" [matMenuTriggerFor]="servicesMenu"
        #servicesTrig="matMenuTrigger" (click)="openMega(servicesTrig)" title="Services menu">
        <mat-icon class="mi">apps</mat-icon>
        <span>{{ 'nav.services' | t }}</span>
        <mat-icon class="chev">expand_more</mat-icon>
      </button>

      <!-- Entities Mega Trigger -->
      <button mat-button class="menu-link menu-trigger" [matMenuTriggerFor]="entitiesMenu"
        #entitiesTrig="matMenuTrigger" (click)="openMega(entitiesTrig)" title="Entities menu">
        <mat-icon class="mi">account_balance</mat-icon>
        <span>{{ 'nav.entities' | t }}</span>
        <mat-icon class="chev">expand_more</mat-icon>
      </button>

      <!-- Archive Mega Trigger -->
      <button mat-button class="menu-link menu-trigger" [matMenuTriggerFor]="archiveMenu" #archiveTrig="matMenuTrigger"
        (click)="openMega(archiveTrig)" title="Archive menu">
        <mat-icon class="mi">article</mat-icon>
        <span>{{ 'nav.archive' | t }}</span>
        <mat-icon class="chev">expand_more</mat-icon>
      </button>

      <!-- News Mega Trigger -->
      <button mat-button class="menu-link menu-trigger" [matMenuTriggerFor]="newsMenu" #newsTrig="matMenuTrigger"
        (mouseenter)="openMega(newsTrig)" title="News">
        <mat-icon class="mi">newspaper</mat-icon>
        <span>{{ 'nav.news' | t }}</span>
        <mat-icon class="chev">expand_more</mat-icon>
      </button>

    </div>
  </nav>

  <!-- =====================================================
       4) MEGA MENUS (Services / Entities / Archive)
  ====================================================== -->

  <!-- SERVICES -->
  <mat-menu #servicesMenu="matMenu" class="mega-panel" [overlapTrigger]="false" [hasBackdrop]="false" yPosition="below"
    [xPosition]="langDir === 'rtl' ? 'before' : 'after'">

    <div class="mega" (mouseenter)="onMenuHover(true)"
      (mouseleave)="onMenuHover(false); scheduleMegaClose(servicesTrig)">

      <div class="mega-top">
        <mat-icon>apps</mat-icon>
        <div>
          <div class="mega-title">{{ 'nav.services' | t }}</div>
          <div class="mega-sub">
            {{ lang.current === 'ar'
            ? 'تصنيفات وخدمات إلكترونية'
            : 'Categories & e-services' }}
          </div>
        </div>
      </div>

      <div class="mega-grid">
        <div class="mega-col" *ngFor="let col of servicesMega">
          <div class="mega-h">{{ col.titleKey | t }}</div>
          <a class="mega-item" *ngFor="let it of col.items" [routerLink]="it.path" (click)="servicesTrig.closeMenu()">
            <mat-icon>{{ it.icon }}</mat-icon>
            <span>{{ it.key | t }}</span>
          </a>
        </div>
      </div>

    </div>
  </mat-menu>

  <!-- ENTITIES -->
  <mat-menu #entitiesMenu="matMenu" class="mega-panel" [overlapTrigger]="false" [hasBackdrop]="false" yPosition="below"
    [xPosition]="langDir === 'rtl' ? 'before' : 'after'">

    <div class="mega" (mouseenter)="clearMegaClose()" (mouseleave)="scheduleMegaClose(entitiesTrig)">

      <div class="mega-top">
        <mat-icon>account_balance</mat-icon>
        <div>
          <div class="mega-title">{{ 'nav.entities' | t }}</div>
          <div class="mega-sub">
            {{ lang.current === 'ar'
            ? 'الجهات والإدارات والهيئات'
            : 'Departments & authorities' }}
          </div>
        </div>
      </div>

      <div class="mega-grid">
        <div class="mega-col" *ngFor="let col of entitiesMega">
          <div class="mega-h">{{ col.titleKey | t }}</div>
          <a class="mega-item" *ngFor="let it of col.items" [routerLink]="it.path" (click)="entitiesTrig.closeMenu()">
            <mat-icon>{{ it.icon }}</mat-icon>
            <span>{{ it.key | t }}</span>
          </a>
        </div>
        <!-- Added Companies Section -->
        <div class="mega-col">
          <div class="mega-h">{{ lang.current === 'ar' ? 'الشركات' : 'Companies' }}</div>
          <a class="mega-item" routerLink="/companies" (click)="entitiesTrig.closeMenu()">
            <mat-icon>business</mat-icon>
            <span>{{ lang.current === 'ar' ? 'الشركات' : 'Companies' }}</span>
          </a>
        </div>
      </div>

    </div>
  </mat-menu>

  <!-- ARCHIVE -->
  <mat-menu #archiveMenu="matMenu" class="mega-panel" [overlapTrigger]="false" [hasBackdrop]="false" yPosition="below"
    [xPosition]="langDir === 'rtl' ? 'before' : 'after'">

    <div class="mega" (mouseenter)="clearMegaClose()" (mouseleave)="scheduleMegaClose(archiveTrig)">

      <div class="mega-top">
        <mat-icon>article</mat-icon>
        <div>
          <div class="mega-title">{{ 'nav.archive' | t }}</div>
          <div class="mega-sub">
            {{ lang.current === 'ar'
            ? 'أخبار، إعلانات، وثائق ووسائط'
            : 'News, announcements, documents & media' }}
          </div>
        </div>
      </div>

      <div class="mega-grid">
        <div class="mega-col" *ngFor="let col of archiveMega">
          <div class="mega-h">{{ col.titleKey | t }}</div>
          <a class="mega-item" *ngFor="let it of col.items" [routerLink]="it.path" (click)="archiveTrig.closeMenu()">
            <mat-icon>{{ it.icon }}</mat-icon>
            <span>{{ it.key | t }}</span>
          </a>
        </div>
      </div>

    </div>
  </mat-menu>

  <!-- NEWS -->
  <mat-menu #newsMenu="matMenu" class="mega-panel" [overlapTrigger]="false" [hasBackdrop]="false" yPosition="below"
    [xPosition]="langDir === 'rtl' ? 'before' : 'after'">

    <div class="mega" (mouseenter)="clearMegaClose()" (mouseleave)="scheduleMegaClose(newsTrig)">

      <!-- ===== TOP HEADER (same as archive) ===== -->
      <div class="mega-top">
        <mat-icon>newspaper</mat-icon>
        <div>
          <div class="mega-title">
            {{ 'nav.news' | t }}
          </div>
          <div class="mega-sub">
            {{ lang.current === 'ar'
            ? 'أنواع الأخبار والتصنيفات'
            : 'News categories & classifications' }}
          </div>
        </div>
      </div>

      <!-- ===== GRID ===== -->
      <div class="mega-grid">

        <!-- Single column (can expand later) -->
        <div class="mega-col">
          <div class="mega-h">
            {{ 'nav.news' | t }}
          </div>

          <a class="mega-item" *ngFor="let type of dataSource" (click)="goToNewsType(type.id); newsTrig.closeMenu()">

            <mat-icon>label</mat-icon>
            <span>{{ getNewsTypeName(type) }}</span>
          </a>

          <!-- Empty state -->
          <div class="mega-empty" *ngIf="!dataSource.length">
            {{ 'common.noData' | t }}
          </div>

        </div>
      </div>

    </div>
  </mat-menu>



  <!-- =====================================================
       5) NEWS TICKER
  ====================================================== -->
  <div class="ticker" [attr.dir]="langDir">
    <div class="container ticker-inner">

      <div class="ticker-label">
        <mat-icon>campaign</mat-icon>
        <span>{{ lang.current === 'ar' ? 'تنويه' : 'Notice' }}</span>
      </div>

      <div class="ticker-track">
        <div class="ticker-move">
          <a class="ticker-item" *ngFor="let n of tickerItems" routerLink="/archive" [title]="tickerText(n)">
            {{ tickerText(n) }}
          </a>
          <!-- duplicated for seamless scroll -->
          <a class="ticker-item" *ngFor="let n of tickerItems" routerLink="/archive" [title]="tickerText(n)">
            {{ tickerText(n) }}
          </a>
        </div>
      </div>

    </div>
  </div>

</header>