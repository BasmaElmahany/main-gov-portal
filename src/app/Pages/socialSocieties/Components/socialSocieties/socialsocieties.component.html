<div *ngIf="!loading" class="culturecenters-container" [class.rtl]="lang.current === 'ar'">
    <div class="page-header">
        <h1 class="page-title">{{ lang.current === 'ar' ? 'الجمعيات الاجتماعية' : 'Social Societies' }}</h1>
        <div class="title-underline"></div>
    </div>

    <div class="controls-bar">
        <div class="search-container">
            <div class="search-box">
                <mat-icon class="search-icon">search</mat-icon>
                <input 
                    type="text" 
                    [(ngModel)]="searchQuery"
                    (ngModelChange)="onSearch()"
                    [placeholder]="lang.current === 'ar' ? 'ابحث عن جمعية...' : 'Search society...'"
                    class="search-input">
                <button 
                    *ngIf="searchQuery" 
                    (click)="clearSearch()"
                    class="clear-search-btn"
                    mat-icon-button>
                    <mat-icon>close</mat-icon>
                </button>
            </div>
            <span class="search-info">
                {{ filteredSocialSocieties.length }} {{ lang.current === 'ar' ? 'نتيجة' : 'results' }}
            </span>
        </div>

        <div class="view-toggle">
            <button 
                mat-icon-button 
                [class.active]="viewMode === 'grid'"
                (click)="viewMode = 'grid'">
                <mat-icon>grid_view</mat-icon>
            </button>
            <button 
                mat-icon-button 
                [class.active]="viewMode === 'list'"
                (click)="viewMode = 'list'">
                <mat-icon>view_list</mat-icon>
            </button>
        </div>

        <div class="page-size-selector">
            <mat-select 
                [(value)]="pageSize"
                (selectionChange)="changePageSize($event.value)"
                class="page-size-select">
                <mat-option *ngFor="let size of pageSizeOptions" [value]="size">
                    {{ size }} {{ lang.current === 'ar' ? 'عنصر' : 'items' }}
                </mat-option>
            </mat-select>
        </div>
    </div>

    <div [class]="viewMode === 'grid' ? 'culturecenter-grid' : 'culturecenter-list'">
        <mat-card 
            *ngFor="let society of paginatedSocialSocieties; let i = index" 
            class="culturecenter-card">
            <div class="card-inner-wrapper"> 
                <div class="card-image-section">
                    <div class="image-wrapper">
                        <img [src]="cover(society)" class="culturecenter-image" (error)="onImageError($event, society)">
                        <div class="image-overlay"></div>
                        <div class="culturecenter-badge">
                            <span class="badge-text">{{ lang.current === 'ar' ? 'جمعية أهلية' : 'Social Society' }}</span>
                        </div>
                    </div>
                </div>
                <div class="card-content">
                    <div class="card-header">
                        <h3 class="culturecenter-name">{{ title(society) }}</h3>
                        <div class="header-line"></div>
                    </div>
                    <div class="card-actions">
                        <button mat-button (click)="openDetails(society.id)" class="action-button">
                            <span class="button-text">{{ lang.current === 'ar' ? 'استكشف التفاصيل' : 'View Details' }}</span>
                            <mat-icon class="button-icon">arrow_back</mat-icon>
                        </button>
                    </div>
                </div>
            </div>
            <div class="decorative-corner top-right"></div>
            <div class="decorative-corner bottom-left"></div>
        </mat-card>
    </div>

    <div class="pagination-container" *ngIf="filteredSocialSocieties.length > pageSize">
        <div class="pagination-wrapper">
            <div class="page-navigation">
                <button mat-icon-button [disabled]="currentPage === 1" (click)="goToFirstPage()" class="nav-button">
                    <mat-icon>first_page</mat-icon>
                </button>
                <button mat-icon-button [disabled]="currentPage === 1" (click)="goToPreviousPage()" class="nav-button">
                    <mat-icon>chevron_right</mat-icon>
                </button>
                
                <div class="page-numbers">
                    <button 
                        *ngFor="let page of getPageNumbers()"
                        (click)="goToPage(page)"
                        [class.active]="page === currentPage"
                        class="page-number">
                        {{ page }}
                    </button>
                </div>

                <button mat-icon-button [disabled]="currentPage === totalPages" (click)="goToNextPage()" class="nav-button">
                    <mat-icon>chevron_left</mat-icon>
                </button>
                <button mat-icon-button [disabled]="currentPage === totalPages" (click)="goToLastPage()" class="nav-button">
                    <mat-icon>last_page</mat-icon>
                </button>
            </div>
        </div>
    </div>
</div>

<div *ngIf="loading" class="loading-state">
    <div class="skeleton-grid">
        <div *ngFor="let item of [1,2,3,4,5,6]" class="skeleton-card"></div>
    </div>
</div>